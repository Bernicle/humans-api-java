<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Material-UI Table Population</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mui/material@5.0.5/dist/css/mui.min.css" integrity="sha512-R4zrnt+8Lo6DqSN51IuRE6bLGyGj5Rj9jrbyA8VEvZkA06jw+0RxXWTt+OGDEAPXe7zRQ1QLIosU0yL1gi4Ryg==" crossorigin="anonymous" /> -->
    <style>
        :root {
            --primary-color: #2196F3;
            --tetradic-color-1: #F44336;
            --tetradic-color-2: #FFC107;
            --tetradic-color-3: #4CAF50;
        }

        body {
            background-color: #f5f5f5;
        }

        .MuiButton-contained {
            background-color: var(--primary-color);
            color: white;
            margin-bottom: 16px;
        }

        .MuiTable-root {
            margin-top: 20px;
            border-collapse: collapse;
            width: 100%;
        }

        .MuiPaper-root {
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 8px;
            background-color: #fff;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .MuiTableRow-root {
            border-bottom: 1px solid #ddd;
        }

        .MuiTextField-root {
            margin-bottom: 16px;
            width: 100%;
        }

        .popup-container {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 20px;
            background-color: rgba(0, 0, 0, 0);
            border: 0px solid #ccc;
            z-index: 1000;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
    </style>
</head>
<body>

    <div style="padding: 16px;">
        <h2 style="color: var(--primary-color);">Human Resources Management System</h2>

        <button onclick="populateTable()" class="MuiButton-root MuiButton-contained">Show Record</button>
        <button onclick="toggleDisplayPopup()" class="MuiButton-root MuiButton-contained">Add New Record</button>

        <div class="overlay" id="overlay"></div>
        <div class="popup-container" id="popup">
            <div class="MuiPaper-root">
                <h3 id = "popup-title-text">Add New Record</h3>
                <div>
                    <div id="pop-id-container" style="display: none;">
                        <label>ID:</label>
                        <label id="popup-id"></label>
                    </div>
                    <div class="MuiTextField-root">
                        <label for="first-name">First Name:</label>
                        <input type="text" id="first-name" placeholder="Enter first name">
                    </div>
                    <div class="MuiTextField-root">
                        <label for="last-name">Last Name:</label>
                        <input type="text" id="last-name" placeholder="Enter last name">
                    </div>
                    <button onclick="addCustomRecord()" class="MuiButton-root MuiButton-contained">Register</button>
                    <button onclick="toggleDisplayPopup()" class="MuiButton-root MuiButton-contained">Close</button>
                </div>
            </div>
        </div>

        <div class="divider" style="border-top: 1px solid #ccc;margin: 10px 0;"></div>

        <div id="data-table-body" class="MuiTableBody-root">
            <!-- Table content will be dynamically added here -->
        </div>
    </div>

    <script>
        // Declare jsonData as a global variable
        var jsonData = [];

        function populateTable() {

            var tableBody = document.getElementById("data-table-body");
            tableBody.innerHTML = '';

            for (var i = 0; i < jsonData.length; i++) {
                var card = document.createElement("div");
                card.className = "MuiPaper-root";

                card.innerHTML = `
                    <strong>ID:</strong> ${jsonData[i].id}<br>
                    <strong>First Name: </strong>${jsonData[i].first_name}<br>
                    <strong>Last Name: </strong>${jsonData[i].last_name}<br>
                    <button onclick="deleteRecord(${jsonData[i].id})" class="MuiButton-root MuiButton-contained">Delete</button>
                    <button onclick="showUpdateGUI(${jsonData[i].id})" id="button-update-${jsonData[i].id}" class="MuiButton-root MuiButton-contained">Click to Update</button>
                `;

                tableBody.appendChild(card);
            }
        }

        function showUpdateGUI(recordId){
            var myDiv = document.getElementById("overlay");
            var myPopup = document.getElementById("popup");
            var popupIdContainer = document.getElementById("pop-id-container");
            var popupTitleText = document.getElementById("popup-title-text");
            
            popupTitleText.textContent = "Update Details";
            popupIdContainer.style.display = "block";
            myDiv.style.display = "block";
            myPopup.style.display = "block";
        }

        // Function to delete a record from jsonData based on ID
        function deleteRecord(recordId) {
            jsonData = jsonData.filter(function(record) {
                return record.id !== recordId;
            });

            populateTable(); // Refresh the table after deletion
        }

        function toggleDisplayPopup() {
            var myDiv = document.getElementById("overlay");
            var myPopup = document.getElementById("popup");
            
            if (myDiv.style.display === "none" || myDiv.style.display === "") {
                myDiv.style.display = "block";
                myPopup.style.display = "block";
            } else {
                myDiv.style.display = "none";
                myPopup.style.display = "none";
            }
        }

        function listOfHuman(id = null, first_name = null, last_name = null) {
            var ddd = null;

            if (id != null){
                var requestOptions = {
                  method: 'GET',
                  redirect: 'follow'
                };

                fetch("http://localhost:8080/api/humans", requestOptions)
                .then(response => response.json())
                .then(result => {
                    ddd = result;
                })
                .catch(error => console.log('error', error));
                return ddd;
            }
            else {
                return ddd
            }
        }

        function addCustomRecord() {
            // Ensure jsonData is initialized
            if (!jsonData) {
                jsonData = [];
            }

            var jjjj = listOfHuman();
            console.log(typeof jjjj);
            console.log(jjjj);

            // Get values from input fields
            var popupIdLabel = document.getElementById("popup-id");
            var firstNameInput = document.getElementById("first-name");
            var lastNameInput = document.getElementById("last-name");
            var popIdContainer = document.getElementById("pop-id-container");
            var popupTitleText = document.getElementById("popup-title-text");
            
            popIdContainer.style.display = "none";
            popupTitleText.textContent = "Add New Record";

            // Check if both fields are filled
            if (firstNameInput.value && lastNameInput.value) {
                // Generate a unique ID (assuming IDs are numbers)
                var newId = jsonData.length > 0 ? jsonData[jsonData.length - 1].id + 1 : 1;

                // Create a new record with input values
                var newRecord = {
                    id: newId,
                    first_name: firstNameInput.value,
                    last_name: lastNameInput.value
                };

                // Add the new record to jsonData
                jsonData.push(newRecord);

                // Call populateTable to refresh the table with the updated data
                populateTable();
                toggleDisplayPopup();
                // Clear input fields
                firstNameInput.value = '';
                lastNameInput.value = '';
            } else {
                alert("Please enter both first name and last name.");
            }
        }
    </script>

    <!-- <script src="https://cdn.jsdelivr.net/npm/react@17/umd/react.development.js"></script> -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/react-dom@17/umd/react-dom.development.js"></script> -->
<!--     <script src="https://cdn.jsdelivr.net/npm/@mui/system@5.0.5/dist/index.esm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mui/material@5.0.5/dist/index.esm.min.js"></script> -->
</body>
</html>
